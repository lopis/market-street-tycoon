document.write('<!doctype html><meta charset=UTF-8><meta content="width=device-width,initial-scale=1,maximum-scale=1,user-scalable=0" name=viewport><title>Market Street Tycoon</title><link rel="shortcut icon" type=image/x-icon><style>#c2d{height:100vh;aspect-ratio:160/144;position:absolute;image-rendering:pixelated;background-color:#000}body,html{margin:0;background-color:#111;display:flex;justify-content:center;align-items:center;height:100%;user-select:none}@media (max-width:900px){body{background:#f7cebd}#gamepad{position:fixed;top:0;left:0;height:100vh;width:100vw}b{position:absolute;display:inline-flex;border:2px solid;border-radius:7vmax;height:7vmax;width:7vmax;font-size:3vmax;color:#b85930;justify-content:center;align-items:center;font-family:monospace;transition:50ms ease-in-out}b:active{color:#f7cebd;transform:scale(1.2)}#down,#up{left:8vmax;bottom:20vmax}#down{bottom:7vmax}#left,#right{left:1.5vmax;bottom:13.5vmax}#right{left:14.5vmax}#ok{right:8vmax;bottom:13.5vmax}}@media (orientation:portrait){body{align-items:flex-start;padding-top:20vh}#gamepad{top:-10vw;left:4vw}#c2d{height:auto;width:100vw}#ok{right:7vmax}}</style><div id=gamepad><b id=up>▲</b><b id=down>▼</b><b id=left>◀</b><b id=right>▶</b><b id=ok>OK</b></div><canvas id=c2d></canvas><canvas id=font height=20 hidden style="border:1px solid" width=250></canvas>');let k=!1,l,p,q,r=(a,b,c)=>{let d=a.createOscillator(),f=a.createGain(),e=a.createBiquadFilter();e.type="bandpass";e.frequency.setValueAtTime(800,c);d.type="square";d.connect(f);f.connect(e).connect(a.destination);f.gain.setValueAtTime(1E-4,c);f.gain.linearRampToValueAtTime(.3,c+.2);f.gain.setValueAtTime(.3,c+.2);f.gain.setValueAtTime(.3,c+.175);f.gain.linearRampToValueAtTime(.01,c+.375);d.frequency.setValueAtTime(440/1.06**b,c);return d},t=[],aa={E:-5,F:-4,G:-2,a:0,b:2,c:3,d:5,e:7,"-":-999};
"GddGddGccGccGeeGeeFddFddEaaGddGddaddGddaddGdbG--".split("").forEach(a=>{t.push(-aa[a])});
let u=!0,v=0,w=0,y=(a=!1)=>{if(u){if(w+.25*v<l.currentTime){var b=w+.25*v;let f=r(l,t[v],b);var c=q=l.createBufferSource(),d=.25*l.sampleRate;let e=l.createBuffer(1,d,l.sampleRate),g=e.getChannelData(0);for(let h=0;h<d;h++)g[h]=2*Math.random()-1;c.buffer=e;c=l.createBiquadFilter();c.type="bandpass";c.frequency.setValueAtTime(500,b);d=l.createGain();d.gain.setValueAtTime(.01,b);d.gain.exponentialRampToValueAtTime(.3,b+.1175);d.gain.setValueAtTime(.3,b+.25*(.9-.47));d.gain.exponentialRampToValueAtTime(.01,
b+.25);q.connect(c).connect(d).connect(l.destination);q.start();f.start(b);f.stop(b+.375);v++;if(v==t.length){if(!a)return;w=l.currentTime+.25;v=0}}setTimeout(y,.25)}},A=(a=2)=>{if(!k){p||(p=new AudioContext);var b=p.currentTime;a=r(p,a,b);a.start(b);a.stop(b+.25)}},B="apples bread oil wood eggs pies ceramics gems spice".split(" "),C="Catarina Leonor Bento Marcos Angela Isabel Manuel Gloria Teresa Vicente Jacinta Joao Diogo Simao Luciana Gil".split(" "),D=()=>{let a=C.pop();C.unshift(a);return a};
function ba(a){a.m=a.m.filter(b=>0<b.l)}
function ca(a){if(!a.m.some(c=>a.s>=c.j)){a.m=a.m.filter(c=>"wood"!=c.B);var b=Math.min(60,Math.ceil(a.s/2));a.m.push({B:"wood",P:D(),j:2*b,l:b})}for(;3>a.m.length;){b=["apples","bread","oil","wood","eggs"];25<a.u.apples&&25<a.u.bread&&25<a.u.eggs&&b.push("pies");Object.values(a.u).some(f=>25<f)&&(b.push("ceramics"),b.push("spice"));25<a.u.ceramics&&b.push("gems");b=b.filter(f=>!a.m.some(e=>e.B==f));b=b[Math.floor(Math.random()*(b.length-.01))];let c=Math.round(15*(a.u[b]||0)/100*Math.random()+5),
d=Math.round(c*(a.T[b]||1)*(.6+.6*Math.random()));a.m.push({B:b,P:D(),j:d,l:c})}}function da(a,b,c){a.history[a.v]={N:b,R:c}}
class ea{constructor(){this.m=[];this.l={};this.j={};this.D={};this.u={};this.N={bread:1,apples:.6,oil:.5,eggs:.8,wood:1,ceramics:.5,pies:.8,gems:.8,spice:1};this.T={bread:6,apples:8,eggs:4,oil:16,wood:3,ceramics:20,pies:10,gems:30,spice:40};this.U={bread:1,apples:.4,eggs:.1,oil:0,wood:0,ceramics:0,pies:1,gems:0};this.v=1;this.history=[];this.s=15;let a=Array(C.length);for(;0!=C.length;){let b=Math.round(Math.random()*(a.length-1));for(;a[b];)b=(b+1)%a.length;a[b]=C.pop()}C=a;this.m=[{B:"apples",
P:D(),j:15,l:6},{B:"bread",P:D(),j:15,l:5},{B:"oil",P:D(),j:64,l:4}]}save(){localStorage.setItem("market_street_tycoon_history",JSON.stringify({history:this.history,m:this.m,s:this.s,l:this.l,u:this.u,D:this.D,j:this.j,v:this.v}))}delete(){localStorage.removeItem("market_street_tycoon_history")}}function E(a,b){var c=[];a.g.V?.();a.g=b;a.g.M?.(...c)}class F{constructor(a,...b){this.g=a;this.g.M?.(...b)}}let G,H;function I(a,b,c){b=b.targetTouches[0]?.target?.id;c?b&&(a.o=b):a.o=""}
function L(a,b){var c=M;c.K&&!c.g.K&&0<a.selection&&(a.selection--,A());c.H&&!c.g.H&&a.selection<b&&(a.selection++,A())}
class fa{constructor(){this.O=this.A=this.J=this.I=this.H=this.K=!1;this.h=new Map;this.o="";this.g={K:this.K,H:this.H,I:this.I,J:this.J,A:this.A,O:this.O};document.addEventListener("keydown",a=>{this.h.set(a.code,!0)});document.addEventListener("keyup",a=>{this.h.set(a.code,!1)});this.i=new DOMPoint;document.addEventListener("touchstart",a=>I(this,a,!0));document.addEventListener("touchend",a=>I(this,a,!1))}}
let M=new fa,N={apples:{data:"@X@@C@RSERRBWRGx\u007f@",size:6,padding:6,y:0},bread:{data:"hmmEmoomm}}momm}hmmExmmGx\u007f\u007fG@@@@",size:8,padding:9,y:-1},oil:{data:"@mm@@m@@XC@[[[X[[C_[{x\u007f\u007fG",size:7,padding:9,y:-1},wood:{data:"@II@HIIAHIIAH\u007f\u007fAxmmGx}oGxmmG@\u007f\u007f@",size:8,padding:8,y:-2},pies:{data:"@@@@x\u007f\u007fGojjzWUU}\u007f\u007f\u007f\u007f\u007f\u007f\u007f\u007fx\u007f\u007fG@@@@",size:8,padding:9,y:0},ceramics:{data:"PRRB@RR@PRRBQRRJJIIQRRRRQRRJHIIA",size:8,
padding:9,y:-1},gems:{data:"@@@@`d@hdlh`dhE@@EE@E@mE@",size:7,padding:10,y:-1},spice:{data:"@@@@@PG@@Rz@PRWGRRzzPRWG@@@@@@@@",size:8,padding:8,y:-1},eggs:{data:"hEhmEmmhmEhE@",size:5,padding:5,y:0}};function ha(a){L(a,a.h.length);let b=M.I&&!M.g.I,c=M.J&&!M.g.J;if(b||c)a.selection<a.h.length?(A(b?2:-2),ia(a,b)):(A(),a.o=!a.o);M.A&&!M.g.A&&2===a.i&&(a.selection==a.h.length&&(a.o?E(H,new O(a.g,!0)):(a.i=0,setTimeout(()=>{E(H,new ja(a.g))},1200))),A(-2))}
function ia(a,b){a.active=[a.selection,b?"\u2013":"+"];setTimeout(()=>{a.active=[-1,""]},100);let c=a.h[a.selection];c&&void 0!=a.g.j[c]&&(a.g.j[c]=Math.max(0,a.g.j[c]+(b?-1:1)))}
class ka{constructor(a){this.selection=0;this.active=[-1,""];this.h=[];this.i=2;this.C=this.o=!1;this.g=a}M(){this.h=B.filter(a=>{let b=this.g.l[a];this.g.j[a]||(this.g.j[a]=1);return!!b});this.o=this.C=!this.h.length}L(a=0){P(this.g.v);Q("Stock",this.g);this.C&&R(S,"Your stock is empty",80,48,"#ffeae0","center");let b=0;T(60*-Math.max(0,Math.min(this.h.length-2,this.selection)));this.h.forEach(c=>{let d=60*b+15;var f=this.g.l[c];let e=this.g.D[c]||0;f&&(U(S,N[c],3,d+1),R(S,c,14,d+1,"#ffeae0"),R(S,
`Stock: ${f}`,1,d+12,"#ffeae0"),R(S,`Avg cost: ${e}$`,1,d+24,"#ffeae0"),f=Math.min(5,1+Math.round(4*(this.g.u[c]||0)/100)),R(S,`Reputation: ${"*".repeat(f)}${")".repeat(5-f)}`,1,d+36,"#ffeae0"),["-","+"].map((g,h)=>V(100+53*h,d+5,this.selection===b?"white":"#FFFFFF88",g,this.active[0]===b&&this.active[1]===g)),c=this.g.j[c],R(S,c?`${c}$`:"N/A",127,d+7,"#ffeae0","center"),b++)});S.g.restore();!this.C&&V(130,129,this.o||this.selection!==this.h.length?"#FFFFFF88":"white","next");V(30,129,this.o&&this.selection===
this.h.length?"white":"#FFFFFF88","back");2!=this.i&&(this.i=Math.min(1,this.i+a/1E3),W(1-this.i));ha(this)}}function la(a){L(a,a.g.m.length);M.A&&!M.g.A&&(a.active=a.selection,setTimeout(()=>{a.active=-1},100),a.selection==a.g.m.length&&(A(-2),E(H,new ka(a.g))),ma(a))}function ma(a){let b=a.g.m[a.selection];if(b)if(0<b.l&&b.j<=a.g.s){A(-2);a.g.s-=b.j;var c=a.g.j[b.B]||0,d=a.g.l[b.B]||0;a.g.D[b.B]=Math.round(10*(a.g.D[b.B]&&c?(b.j+c*d)/(b.l+d):b.j/b.l))/10;a.g.l[b.B]=d+b.l;b.l=0}else A(5)}
class O{constructor(a,b=!1){this.selection=0;this.active=-1;this.i=!1;this.h=0;this.g=a;this.i=b}M(){ba(this.g);this.i||(this.g.save(),ca(this.g))}L(a=0){this.h+=a;P(this.g.v);Q("Suppliers",this.g);this.g.m.forEach((b,c)=>{let d=28*c+15;U(S,N[b.B],3,d+6);R(S,b.P,14,1+d,"#ffeae0");let f=`${b.l} ${b.B} ${b.j}$`;R(S,b.l?f:"soldout",14,d+13,"#ffeae0");V(140,d+5,this.selection===c?"white":"#FFFFFF88","BUY",this.active===c)});V(130,129,this.selection===this.g.m.length?"white":"#FFFFFF88","next");1<this.g.v&&
!this.i&&500<this.h&&3E3>this.h&&R(S,"Game saved",5,132,"#00000088");la(this)}}
class na{constructor(a){this.total=this.h=this.selection=0;this.i={};this.g=a}V(){this.g.s+=this.total}M(){let a=this.g.history[this.g.v];Object.keys(a.R).map(b=>{let c=a.R[b]=Math.round(a.R[b]||0);a.N[b]=1E4*(a.N[b]||0)/20;this.total+=c*(this.g.j[b]||0);let d=Math.max(0,(this.g.l[b]||0)-c),f=Math.round((this.g.U[b]||0)*d);this.g.l[b]=d-f;this.i[b]=f;this.g.u[b]=(this.g.u[b]||0)+c})}L(a=0){P(this.g.v);Q("Summary",this.g,this.total);if(0===this.g.s+this.total)["You ran out of money.","GAME OVER"].map((d,
f)=>{R(S,d,80,48+15*f,"#ffeae0","center")}),V(80,129,"white","return");else{V(130,129,"white","next");var b=Object.values(this.g.l).filter(g=>!!g).length;let d=this.g.history[this.g.v],f=Object.entries(d.R),e=60*Math.max(0,b-2);var c=e/20;this.selection>c&&(this.selection=Math.round(e/20));T(20*-this.selection);f.map((g,h)=>{h=60*h+15;let m=g[0];g=g[1];U(S,N[m],3,h);var n=Math.round(Math.min(10,10*(d.N[m]||0)));R(S,`${m}`,12,h,"#ffeae0");R(S,`Demand: ${"(".repeat(n)}${"'".repeat(10-n)}`,2,h+12,"#ffeae0");
n=this.g.j[m]||0;g=`${g} x ${n}$ = ${g*n}$`;R(S,16<g.length?g:`Sales: ${g}`,2,h+24,"#ffeae0");R(S,this.g.U[m]?`Spoiled: ${this.i[m]}`:"Does not spoil",2,h+36,"#ffeae0")});S.g.restore();1>this.h&&(this.h=Math.min(1,this.h+a/1E3),W(this.h));if(2<f.length){let {width:g,height:h}=V(150,32,"#FFFFFF88","<");V(150,92,"#FFFFFF88",">");a=60-h;b=Math.floor(2*a/b);c=Math.round((a-b)*this.selection/c);S.g.fillStyle="white";S.g.fillRect(150-g/2,32+h+c,g,b)}}L(this,99);M.A&&!M.g.A&&(0===this.g.s+this.total&&(this.g.delete(),
document.dispatchEvent(new Event("restart"))),this.g.v++,A(-2),E(H,new O(this.g)))}}
class ja{constructor(a){this.S=[];this.C={};this.i={};this.o=[];this.time=this.h=0;this.g=a;for(a=20;a--;){let b=.5<Math.random()?1:-1;this.S.push({height:Math.round(10*Math.random()-5),step:Math.round(160*Math.random()*b),speed:(.5*Math.random()+.5)*b})}}M(){k||(l=new AudioContext,w=l.currentTime,w=v=0,u=!0,y(!1));this.o=B.filter(a=>{let b=this.g.l[a]||0;return 0<(this.g.j[a]||0)&&0<b}).slice(0,3);B.map(a=>{this.g.l[a]&&(this.C[a]=(this.g.T[a]||0)/(this.g.j[a]||1)*(this.g.N[a]||0)*Math.max(.2,(this.g.u[a]||
0)/100)*20/9999.5,this.i[a]=0)})}L(a=0){oa();pa();qa();ra(this.g,this.i,this.o);sa(this.g,this.i);ta(this.S);ua(this.time);1E4>this.time&&(this.time+=a,this.o.forEach(b=>{if(this.g.j[b]){var c=this.C[b]||0,d=this.i[b]||0;d<(this.g.l[b]||0)&&(this.i[b]=d+c*a)}}));1E4<this.time?0<this.h?this.h=Math.max(0,this.h-a/1E3):(da(this.g,this.C,this.i),E(H,new na(this.g))):1>this.h&&(this.h=Math.min(1,this.h+a/1E3));W(this.h)}}
let va=" 2rwzo 6v7ic 58jgo jp1dr jz6rj 2pav8 dehn9 34ao 3o b28 3k 1d9c8 9a7vy j0dzz jf63j ivhmm etlgn ju8e7 j7sjj jez7y jwdj3 jwag3 2t8g 2t8s 34yo lskg m2yo jf4lo jysjy 98ruh j8htq 98qwe j8d32 ju78f ju788 9ul2n g44e1 jfm3j jewdq g4rbt fgsgv hha5t g6xgz 98rou j8d7c 98uwe j8d7d 9x3i6 jfm2s g3zni g3znw b1ipn h4qu3 b5cas jhyfz    ".split(" "),wa=a=>a.replace(/^#?([a-f\d])([a-f\d])([a-f\d])([a-f\d])$/i,(b,c,d,f,e)=>"#"+c+c+d+d+f+f+e+e).substring(1).match(/.{2}/g).map(b=>parseInt(b,16));
function P(a){var b=S;let c=["#2f00b1","#631909","#00771a","#004fc5"];b.g.fillStyle=c[a%c.length];b.g.fillRect(0,0,160,144)}function Q(a,b,c=-1){var d=S;d.g.fillStyle="#00000088";d.g.fillRect(0,0,160,12);R(d,`Week ${b.v} - ${a}`,3,3,"#c3472c");a=b.s;R(d,`${1E3>a?a:1E6>a?`${Math.round(a/100)/10}k`:`${Math.round(a/1E6)/10}M`}$`,160,3,"#00771a","right");-1!=c&&R(d,`+ ${c}$`,160,13,"#00000088","right")}
function R(a,b,c,d,f="#ffeae0",e="left"){b||(b=" ");let g=6*b.length,h=b+f;e="left"===e?0:"center"===e?g/2:g;if(a.i[h])a.g.drawImage(a.i[h],c-e,d);else{let m=new ImageData(g,5),[n,x,J,Ba]=wa(f);b.toUpperCase().split("").forEach((K,Ca)=>{String(parseInt(" "===K?"0":va[K.charCodeAt(0)-35],36).toString(2)).padStart(25,"0").split("").forEach((z,Z)=>{"0"!==z&&(z=4*(6*Ca+Z%5+g*Math.floor(Z/5)),m.data[z]=n,m.data[z+1]=x,m.data[z+2]=J,m.data[z+3]=Ba||255)})});createImageBitmap(m).then(K=>{a.i[h]=K})}}
function T(a){var b=S;b.g.save();b.g.rect(0,12,160,114);b.g.clip();b.g.translate(0,a)}function U(a,b,c,d){let f=[];[...b.data].map(e=>{e=e.charCodeAt(0);f.push(e&7);f.push(e>>3&7)});for(let e=0;e<b.size;e++)for(let g=0;g<b.size;g++)if(f[e*b.size+g]){let h=3*(f[e*b.size+g]-1);a.g.fillStyle="#"+"533c422c415bea0ddd642".substring(h,h+3);a.g.fillRect(c+g,d+e,1,1)}}
function V(a,b,c,d,f=!1){var e=S;f=f?1:0;e.g.strokeStyle=c;e.g.fillStyle=c;c=6*(d.length+1);e.g.translate(f,f);e.g.fillRect(a-c/2,b,c,13);R(e,d,a,b+4,"#251108","center");e.g.translate(-f,-f);return{width:c,height:13}}
function W(a){var b=S;let c=4;for(;c--;){let d=4;for(;d--;){let f=Math.round(-(Math.cos(Math.PI*a)-1)/2*(160+32*d)),e=36*d;b.g.fillStyle="#c3472c";b.g.fillRect(20*c-f,e,17,36);b.g.fillRect(160-20*(c+1)+f,e,17,36);b.g.fillStyle="#631909";b.g.fillRect(160-20*(c+1)+17+f,e,3,36);b.g.fillRect(20*c-f+17,e,3,36)}}}
function oa(){var a=S;for(let f=0;10>=f;f++)for(let e=0;6>=e;e++){var b=a,c=26*e-(f%2?18:5),d=16*f-5;b.g.fillStyle="#251108";b.g.fillRect(c,d,26,16);b.g.fillStyle="#807b78";b.g.fillRect(c+1,d+1,25,15)}a.g.fillStyle="#251108";a.g.fillRect(0,90,160,54)}
function pa(){var a=S;a.g.fillStyle=X(a,30,0,38,0);a.g.fillRect(30,23,8,85);a.g.fillStyle=X(a,122,0,130,0);a.g.fillRect(122,23,8,85);a.g.fillStyle=X(a,0,23,0,27);a.g.fillRect(18,23,124,4);for(let b=0;7>b;b++)a.g.beginPath(),a.g.fillStyle=b%2?"#d5ad9b":"#631909",Y(a,32+16*b,32,8),a.g.fill(),a.g.beginPath(),a.g.fillStyle=b%2?"#ffeae0":"#c3472c",Y(a,32+16*b,30,8),a.g.rect(24+16*b,22,16,8),a.g.fill()}
function qa(){var a=S;for(let b=0;3>b;b++)a.g.fillStyle="#8f3e15",a.g.fillRect(35+30*b,76,30,36),a.g.fillStyle="#de7c4b",a.g.fillRect(30*b+36,100,28,3),a.g.fillRect(30*b+36,104,28,3),a.g.fillRect(30*b+36,108,28,3),a.g.fillStyle="#251108",a.g.fillRect(30*b+36,77,28,22)}
function ra({l:a},b,c){var d=S;let f=Object.entries(a).filter(([e,g])=>g&&c.includes(e));f.forEach(([e,g],h)=>{g=Math.min(200,Math.ceil(g-b[e]));e=N[e];let m=Math.floor(27/e.padding);h=1===f.length?1:2===f.length?2*h:h;let n=Math.min(g,m*Math.ceil(25/e.padding));for(let x=0;x<g;x++){let J=Math.floor(x/n);U(d,e,37+x%m*e.padding+30*h+J%2*e.padding*.5,90-Math.floor(x%n/m)*(e.padding-1)-e.y-J*e.padding)}})}
function sa(a,b){var c=S;b=Object.entries(b).reduce((d,[f,e])=>d+(a.j[f]||0)*Math.floor(e),0);c.g.fillStyle="#ffeae0";c.g.fillRect(3,3,50,11);c.g.fillRect(107,3,50,11);R(c,`Week ${a.v}`,5,6,"#251108");R(c,`${a.s+b}$`,155,6,"#251108","right")}
function ta(a){var b=S;b.g.beginPath();b.g.fillStyle="#00000055";a.forEach(c=>{let d=120+c.height+Math.round(Math.sin(c.step/2)),f=Math.round(c.step);Y(b,f+17,d,10,.7);Y(b,f,d+20,15,.7);c.step+=c.speed;-40>c.step?c.step=200:200<c.step&&(c.step=-40)});b.g.fill()}function ua(a){var b=S;b.g.beginPath();b.g.fillStyle="#ffeae0";Y(b,80,8,7);b.g.fill();a=2*Math.PI*a/1E4-Math.PI/2;xa(b,80+6*Math.cos(a),8+6*Math.sin(a))}function ya(a){a.h.clearRect(0,0,a.h.canvas.width,a.h.canvas.height)}
function xa(a,b,c){let d=80,f=8;b=Math.round(b);c=Math.round(c);b-=80;c-=8;let e=Math.max(Math.abs(b),Math.abs(c));b/=e;c/=e;let g=[];for(a.g.fillStyle="#251108";e--;)g.push([d,f]),d+=b,f+=c;a.g.beginPath();g.map(([h,m])=>{a.g.rect(Math.round(h),Math.round(m),1,1)});a.g.fill()}
function Y(a,b,c,d,f=0){let e=d,g=0,h=0;for(a.g.rect(b-e,c,d<<1,1);e>g;)h-=--e-++g,0>h&&(h+=e++),d=Math.round(f*e),a.g.rect(b-g+d,c-e,g<<1,1),a.g.rect(b-g-d,c+e,g<<1,1),d=Math.round(f*g),a.g.rect(b-e+d,c-g,e<<1,1),a.g.rect(b-e-d,c+g,e<<1,1)}function X(a,b,c,d,f){var e=[[.25,"#8f3e15"],[.75,"#de7c4b"],[1,"#8f3e15"]];let g=a.g.createLinearGradient(b,c,d,f);e.forEach(([h,m],n)=>{0!=n&&g.addColorStop(e[n-1][0],m);g.addColorStop(h,m)});return g}
class za{constructor(){this.time=0;this.i={};this.g=c2d.getContext("2d");this.h=font.getContext("2d",{W:!0});this.g.canvas.height=144;this.g.canvas.width=160}}let S=new za;
class Aa{constructor(a){this.g=new ea;if(!a){a=this.g;let n=localStorage.getItem("market_street_tycoon_history");if(n){var {history:b,m:c,s:d,l:f,u:e,D:g,j:h,v:m}=JSON.parse(n);a.history=b;a.m=c;a.s=d;a.l=f;a.u=e;a.D=g;a.j=h;a.v=m}}H=new F(new O(this.g),...[])}M(){document.addEventListener("restart",()=>{E(G,Da)})}L(a){H.g.L(a)}}
function Ea(a){["\ud835\udd44\ud835\udd52\ud835\udd63\ud835\udd5c\ud835\udd56\ud835\udd65","\ud835\udd4a\ud835\udd65\ud835\udd63\ud835\udd56\ud835\udd56\ud835\udd65","\ud835\udd4b\ud835\udd6a\ud835\udd54\ud835\udd60\ud835\udd60\ud835\udd5f"].map((c,d)=>{d=8+16*d;var f=S;ya(f);f.h.font="20px sans, Droid Sans, Arial, Helvetica";f.h.textBaseline="middle";f.h.textAlign="center";f.h.fillText(c,125,10);c=f.h.getImageData(0,0,250,32);for(let e=0;250>e;e++)for(let g=0;32>g;g++)if(100<c.data[4*(250*g+e)+1]||
100<c.data[4*(250*g+e)+2]||100<c.data[4*(250*g+e)+3])f.g.fillStyle="#ea0",f.h.fillRect(e,g,1,1),f.g.fillRect(e+80-125,g+d,1,1)});let b=["New Game","Continue","FullScreen","Help","About"];localStorage.getItem("market_street_tycoon_history")||b.splice(1,1);b.map((c,d)=>{R(S,`${a.selection==d?"&":" "} ${c}`,10,70+13*d,a.selection==d?"#ffeae0":"#FFFFFF88")})}function Fa(a){a.map((b,c)=>{R(S,b,10,15+8*c,"#ffeae0","left")})}
class Ga{constructor(){this.selection=0;this.h=this.g=!1;this.i=!0}L(){P(1);this.i?(R(S,"Play with sound?",20,46,"#FFFFFF88"),R(S,0==this.selection?"& yes":"  yes",20,58,0==this.selection?"#ffeae0":"#FFFFFF88"),R(S,1==this.selection?"& no":"  no",20,68,1==this.selection?"#ffeae0":"#FFFFFF88")):this.h?(Fa("Game made by lopis;for js13k 2023;;github.com/lopis;js13kgames.com;;%".split(";")),V(80,129,"#ffeae0","return")):this.g?(Fa("You are a merchant in;the village market,;trying to succeed. Buy;goods from the region;and resell them for the;best price, depending on;customer demand. Your;reputation increases;the more you sell each;item and unlocks new;suppliers and products.; ;Use the arrow keys and;Enter to play.".split(";")),
V(80,129,"#ffeae0","return")):Ea(this);L(this,this.h||this.g?100:this.i?1:4);M.A&&!M.g.A&&(this.i?(this.i=!1,1===this.selection&&(k=!0),this.selection=0):this.h||this.g?(this.selection=0,this.g=this.h=!1):1>=this.selection?E(G,new Aa(0===this.selection)):2==this.selection?document.fullscreenElement?document.exitFullscreen():document.documentElement.requestFullscreen():3==this.selection?(this.selection=0,this.g=!0):(this.selection=0,this.h=!0),A())}}let Da=new Ga;
document.querySelector('link[type="image/x-icon"]').href="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'%3E%3Ctext y='.9em' font-size='90'%3E\ud83c\udf4e%3C/text%3E%3C/svg%3E";G=new F(Da,...[]);let Ha=0,Ia=1E3/60;
(function Ja(a){let c=a-Ha;if(c>=Ia){Ha=a;a=M;a.g.K=a.K;a.g.H=a.H;a.g.I=a.I;a.g.J=a.J;a.g.A=a.A;a.g.O=a.O;let d=navigator.getGamepads&&navigator.getGamepads()[0],f=a.h.get("KeyA")||a.h.get("ArrowLeft")||"left"===a.o||d?.buttons[14].pressed?-1:0,e=a.h.get("KeyD")||a.h.get("ArrowRight")||"right"===a.o||d?.buttons[15].pressed?1:0,g=a.h.get("KeyW")||a.h.get("ArrowUp")||"up"===a.o||d?.buttons[12].pressed?-1:0,h=a.h.get("KeyS")||a.h.get("ArrowDown")||"down"===a.o||d?.buttons[13].pressed?1:0;a.i.x=f+e||
d?.axes[0]||0;a.i.y=g+h||d?.axes[1]||0;.1>Math.hypot(a.i.x,a.i.y)&&(a.i.x=0,a.i.y=0);a.K=0>a.i.y;a.H=0<a.i.y;a.I=0>a.i.x;a.J=0<a.i.x;a.A=!!(a.h.get("Enter")||"ok"===a.o||d?.buttons[0].pressed||d?.buttons[9].pressed);a.O=!(!a.h.get("Escape")&&!d?.buttons[8].pressed);a=S;ya(a);a.g.clearRect(0,0,160,144);G.g.L(c)}requestAnimationFrame(Ja)})(0);