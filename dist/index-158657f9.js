let g={apples:{data:"@X@@C@RSERRBWRGx\u007f@",size:6,padding:6,y:0},bread:{data:"hmmEmoomm}}momm}hmmExmmGx\u007f\u007fG@@@@",size:8,padding:9,y:-1},oil:{data:"@mm@@m@@XC@[[[X[[C_[{x\u007f\u007fG",size:7,padding:9,y:-1}};function l(a){a.h.clearRect(0,0,a.h.canvas.width,a.h.canvas.height)}
function n(a,b,c,d,h="white",e="left"){l(a);a.h.font="10px sans";a.h.textBaseline="middle";a.h.textAlign=e;e="center"==e?125:"right"==e?250:0;a.h.fillText(b,e,5);b=a.h.getImageData(0,0,250,32);for(let k=0;250>k;k++)for(let m=0;32>m;m++)if(80<b.data[4*(250*m+k)+1]||80<b.data[4*(250*m+k)+2]||80<b.data[4*(250*m+k)+3])a.g.fillStyle=h,a.h.fillRect(k,m,1,1),a.g.fillRect(k+c-e,m+d,1,1)}function p(){var a=q;a.g.fillStyle="#00000099";a.g.fillRect(0,0,160,144)}
function r(a,b,c,d,h=0){let e=d,k=0,m=0;for(a.g.rect(b-e,c,d<<1,1);e>k;)m-=--e-++k,0>m&&(m+=e++),d=Math.round(h*e),a.g.rect(b-k+d,c-e,k<<1,1),a.g.rect(b-k-d,c+e,k<<1,1),d=Math.round(h*k),a.g.rect(b-e+d,c-k,e<<1,1),a.g.rect(b-e-d,c+k,e<<1,1)}function t(){var a=q;for(let h=0;10>=h;h++)for(let e=0;6>=e;e++){var b=a,c=26*e-(h%2?18:5),d=16*h-5;b.g.strokeStyle="#3f2e28";b.g.fillStyle="#7d736e";b.g.fillRect(c,d,26,16);b.g.strokeRect(c+1,d+1,25,15)}a.g.fillStyle="#40312a";a.g.fillRect(0,90,160,54)}
function u(a,b,c,d,h){var e=[[.25,"#6d412e"],[.75,"#b77e62"],[1,"#6d412e"]];let k=a.g.createLinearGradient(b,c,d,h);e.forEach(([m,C],D)=>{0!=D&&k.addColorStop(e[D-1][0],C);k.addColorStop(m,C)});return k}
function v(){var a=q;a.g.fillStyle=u(a,30,0,38,0);a.g.fillRect(30,23,8,85);a.g.fillStyle=u(a,122,0,130,0);a.g.fillRect(122,23,8,85);a.g.fillStyle=u(a,0,23,0,27);a.g.fillRect(18,23,124,4);for(let b=0;7>b;b++)a.g.beginPath(),a.g.fillStyle=b%2?"#b77e62":"#752a1a",r(a,32+16*b,32,8),a.g.fill(),a.g.beginPath(),a.g.fillStyle=b%2?"#f7cebd":"#c3472c",r(a,32+16*b,30,8),a.g.rect(24+16*b,22,16,8),a.g.fill()}
function w(){var a=q;for(let b=0;3>b;b++)a.g.fillStyle="#6d412e",a.g.fillRect(35+30*b,76,30,36),a.g.fillStyle="#b77e62",a.g.fillRect(30*b+36,100,28,3),a.g.fillRect(30*b+36,104,28,3),a.g.fillRect(30*b+36,108,28,3),a.g.fillStyle="#3f2e28",a.g.fillRect(30*b+36,77,28,22)}function x(a,b,c,d){var h=q;h.g.strokeStyle=c;h.g.fillStyle=c;let e=10*d.length;h.g.strokeRect(a-e/2,b,e,13);n(h,d,a,b+2,c,"center")}
function y(a,b,c){var d=q;let h=[];a.data.replace(/./g,e=>{e=e.charCodeAt();h.push(e&7);h.push(e>>3&7)});for(let e=0;e<a.size;e++)for(let k=0;k<a.size;k++)if(h[e*a.size+k]){let m=3*(h[e*a.size+k]-1);d.g.fillStyle="#"+"000c422a615bea0ddd642".substring(m,m+3);d.g.fillRect(b+k,c+e,1,1)}}function z(a){var b=q;b.g.fillStyle="#f7cebd";b.g.fillRect(3,3,50,12);b.g.fillRect(107,3,50,12);n(b,`Week ${a.G}`,5,5,"#3f2e28");n(b,`${a.v}$`,155,5,"#3f2e28","right")}
function A(a){var b=q;b.g.beginPath();b.g.fillStyle="#00000055";a.forEach(c=>{let d=120+c.height+Math.round(Math.sin(c.step/2)),h=Math.round(c.step);r(b,h+17,d,10,.7);r(b,h,d+20,15,.7);c.step+=c.speed;-40>c.step?c.step=200:200<c.step&&(c.step=-40)});b.g.fill()}function B(){var a=q;let b=performance.now()-a.time;a.time=performance.now();a.i=.99*a.i+1E3/b*.01;a.g.fillText(`${Math.round(a.i)}`,10,134)}
class E{constructor(){this.i=60;this.time=0;this.g=c2d.getContext("2d");this.h=f.getContext("2d");this.g.canvas.height=144;this.g.canvas.width=160}}let q=new E;function F(a,b){var c=[];a.g.H?.();a.g=b;a.g.D?.(...c)}class G{constructor(a,...b){this.g=a;this.g.D?.(...b)}}let H;
class I{constructor(){this.u=this.l=this.m=this.o=!1;this.g=new Map;this.h={o:this.o,m:this.m,l:this.l,u:this.u};document.addEventListener("keydown",a=>{this.g.set(a.code,!0)});document.addEventListener("keyup",a=>{this.g.set(a.code,!1)});this.i=new DOMPoint}}let J=new I;
function K(a){J.o&&!J.h.o&&0<a.h&&a.h--;J.m&&!J.h.m&&a.h<a.g.s.length&&a.h++;if(J.l&&!J.h.l){let b=a.g.s[a.h];b&&0<b.j&&b.B<=a.g.v&&(a.g.v-=b.B,a.g.j[b.C]+=b.j,b.j=0);a.h==a.g.s.length&&document.dispatchEvent(new Event("next"))}}
class L{constructor(a){this.h=0;this.g=a}A(){t();p();n(q,`Week ${this.g.G} - Suppliers`,1,1,"indianred");n(q,`${this.g.v}$`,160,1,"green","right");this.g.s.forEach((a,b)=>{let c=24*b+24;n(q,a.F,1,1+c,"gray");let d=`${a.j} ${a.C}   ${a.B}$`;n(q,a.j?d:"soldout",1,c+11,"gray");x(140,c+5,this.h===b?"white":"gray","BUY")});x(80,129,this.h===this.g.s.length?"white":"gray","next");K(this)}}
let M=["apples","bread","oil"],N="Catarina Leonor Bento Marcos Apar\u00edcia Isabel Manuel Gra\u00e7a Teresa Vicente Jacinta Jo\u00e3o Diogo Luciana Sim\u00e3o Gil".split(" "),O=()=>{let a=N.pop();N.unshift(a);return a};class P{constructor(){this.s=[];this.j={};this.G=1;M.forEach(b=>{this.j[b]=30});this.v=20;var a={C:"apples",F:O(),B:10,j:10};this.s.push(a);a={C:"apples",F:O(),B:20,j:24};this.s.push(a)}}let Q,R,S=[];
[4,6,3,7].forEach((a,b)=>{let c=8;for(;c;)3==b&&5>c?4>c?S.push(99,99):5>c&&S.push(a,99):S.push(a,a-4),c--});
let T=0,U=0,V=()=>{if(U+.2*T<Q.currentTime){var a=S[T],b=U+.2*T;let h=Q.createOscillator();var c=Q.createGain(),d=Q.createBiquadFilter();d.type="bandpass";d.frequency.setValueAtTime(b,1200);h.type="sawtooth";h.connect(c);c.connect(d).connect(Q.destination);c.gain.setValueAtTime(.01,b);d=.8;c.gain.linearRampToValueAtTime(.3,b+.2*d);c.gain.setValueAtTime(.3,b+.2*d);c.gain.setValueAtTime(.3,b+.2*(1.5-d));c.gain.linearRampToValueAtTime(.01,b+.29);h.frequency.value=440/1.06**a;d=R=Q.createBufferSource();
a=.2*Q.sampleRate;c=Q.createBuffer(1,a,Q.sampleRate);let e=c.getChannelData(0);for(let k=0;k<a;k++)e[k]=2*Math.random()-1;d.buffer=c;a=Q.createBiquadFilter();a.type="bandpass";a.frequency.setValueAtTime(b,500);c=Q.createGain();c.gain.setValueAtTime(.01,b);d=.47;c.gain.linearRampToValueAtTime(.3,b+.2*d);c.gain.setValueAtTime(.3,b+.2*d);c.gain.setValueAtTime(.3,b+.2*(.9-d));c.gain.linearRampToValueAtTime(.01,b+.2);R.connect(a).connect(c).connect(Q.destination);R.start();h.start(b);h.stop(b+.2*1.5);
T++;T==S.length&&(U=Q.currentTime+.2,T=0)}setTimeout(V,10)};
class W{constructor(a){this.h=[];this.g=a;for(a=20;a--;){let b=.5<Math.random()?1:-1;this.h.push({height:Math.round(10*Math.random()-5),step:Math.round(160*Math.random()*b),speed:(.5*Math.random()+.5)*b})}}D(){Q=new AudioContext;U=Q.currentTime;V()}A(){t();v();w();console.log(this.g.j);Object.entries(this.g.j).forEach(([a,b],c)=>{console.log(a,b);a=g[a];let d=Math.floor(27/a.padding);b=Math.min(b,d*Math.ceil(25/a.padding));for(let h=0;h<b;h++)y(a,37+h%d*a.padding+30*c+(7>a.padding?Math.floor(h/d)%
2*a.padding/2:0),73+Math.floor(h/d)*(a.padding-1)-a.y)});z(this.g);A(this.h);B()}}class X{constructor(){this.g=new P;this.h=new G(new L(this.g))}H(){document.removeEventListener("next",()=>{F(this.h,new W(this.g))})}D(){document.addEventListener("next",()=>{F(this.h,new W(this.g))})}A(a){this.h.g.A(a)}}let aa=new X;
class ba{constructor(){this.g=!0}A(){t();p();n(q,"Market Street Tycoon",10,40);n(q,"Start",10,60,this.g?"white":"gray");n(q,"Toggle Fullscreen",10,70,this.g?"gray":"white");if(J.o&&!J.h.o||J.m&&!J.h.m)this.g=!this.g;J.l&&!J.h.l&&(this.g?F(H,aa):document.fullscreenElement?document.exitFullscreen():document.documentElement.requestFullscreen())}}H=new G(new ba,...[]);let Y=0,Z=1E3/60;
(function ca(a){let c=a-Y;if(c>=Z){Y=a-c%Z;J.h.o=J.o;J.h.m=J.m;J.h.l=J.l;J.h.u=J.u;a=navigator.getGamepads()[0];let d=J.g.get("KeyA")||J.g.get("ArrowLeft")||a?.buttons[14].pressed?-1:0,h=J.g.get("KeyD")||J.g.get("ArrowRight")||a?.buttons[15].pressed?1:0,e=J.g.get("KeyW")||J.g.get("ArrowUp")||a?.buttons[12].pressed?-1:0,k=J.g.get("KeyS")||J.g.get("ArrowDown")||a?.buttons[13].pressed?1:0;J.i.x=d+h||a?.axes[0]||0;J.i.y=e+k||a?.axes[1]||0;.1>Math.hypot(J.i.x,J.i.y)&&(J.i.x=0,J.i.y=0);J.o=0>J.i.y;J.m=
0<J.i.y;J.l=!!(J.g.get("Enter")||a?.buttons[0].pressed||a?.buttons[9].pressed);J.u=!(!J.g.get("Escape")&&!a?.buttons[8].pressed);a=q;l(a);a.g.clearRect(0,0,160,144);H.g.A(c)}requestAnimationFrame(ca)})(0);
